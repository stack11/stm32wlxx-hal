<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Low-power timer trait."><meta name="keywords" content="rust, rustlang, rust-lang, LpTim"><title>LpTim in stm32wlxx_hal::lptim - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../stm32wlxx_hal/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><h2 class="location">Trait LpTim</h2><div class="sidebar-elems"><div class="block items"><h3 class="sidebar-title"><a href="#associated-types">Associated Types</a></h3><div class="sidebar-links"><a href="#associatedtype.TrgSel">TrgSel</a></div><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><div class="sidebar-links"><a href="#tymethod.clk">clk</a><a href="#tymethod.disable_clock">disable_clock</a><a href="#tymethod.enable_clock">enable_clock</a><a href="#tymethod.free">free</a><a href="#tymethod.new">new</a><a href="#tymethod.pulse_reset">pulse_reset</a></div><h3 class="sidebar-title"><a href="#provided-methods">Provided Methods</a></h3><div class="sidebar-links"><a href="#method.cnt">cnt</a><a href="#method.hz">hz</a><a href="#method.is_enabled">is_enabled</a><a href="#method.isr">isr</a><a href="#method.set_icr">set_icr</a><a href="#method.set_ier">set_ier</a><a href="#method.setup_trigger">setup_trigger</a></div><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div><h2 class="location">Other items in<br><a href="../index.html">stm32wlxx_hal</a>::<wbr><a href="index.html">lptim</a></h2><div id="sidebar-vars" data-name="LpTim" data-ty="trait" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Trait <a href="../index.html">stm32wlxx_hal</a>::<wbr><a href="index.html">lptim</a>::<wbr><a class="trait" href="#">LpTim</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#274-492" title="goto source code">[src]</a></span></h1><div class="docblock item-decl"><pre class="rust trait"><code>pub trait LpTim: LpTim {
    type <a href="#associatedtype.TrgSel" class="type">TrgSel</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a>&gt;;
<details class="rustdoc-toggle type-contents-toggle"><summary class="hideme"><span>Show 13 methods</span></summary>    fn <a href="#tymethod.new" class="fnname">new</a>(tim: Self::Pac, clk: <a class="enum" href="enum.Clk.html" title="enum stm32wlxx_hal::lptim::Clk">Clk</a>, pre: <a class="enum" href="enum.Prescaler.html" title="enum stm32wlxx_hal::lptim::Prescaler">Prescaler</a>, rcc: &amp;mut <a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>) -&gt; Self;
<div class="item-spacer"></div>    fn <a href="#tymethod.free" class="fnname">free</a>(self) -&gt; Self::Pac;
<div class="item-spacer"></div>    unsafe fn <a href="#tymethod.pulse_reset" class="fnname">pulse_reset</a>(rcc: &amp;mut <a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>);
<div class="item-spacer"></div>    fn <a href="#tymethod.enable_clock" class="fnname">enable_clock</a>(rcc: &amp;mut <a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>);
<div class="item-spacer"></div>    unsafe fn <a href="#tymethod.disable_clock" class="fnname">disable_clock</a>(rcc: &amp;mut <a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>);
<div class="item-spacer"></div>    fn <a href="#tymethod.clk" class="fnname">clk</a>(rcc: &amp;<a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>) -&gt; <a class="enum" href="enum.Clk.html" title="enum stm32wlxx_hal::lptim::Clk">Clk</a>;

    fn <a href="#method.hz" class="fnname">hz</a>(&amp;self) -&gt; &amp;<a class="struct" href="../struct.Ratio.html" title="struct stm32wlxx_hal::Ratio">Ratio</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a>&gt; { ... }
<div class="item-spacer"></div>    fn <a href="#method.cnt" class="fnname">cnt</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u16.html">u16</a> { ... }
<div class="item-spacer"></div>    fn <a href="#method.isr" class="fnname">isr</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a> { ... }
<div class="item-spacer"></div>    fn <a href="#method.set_ier" class="fnname">set_ier</a>(&amp;mut self, ier: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a>) { ... }
<div class="item-spacer"></div>    unsafe fn <a href="#method.set_icr" class="fnname">set_icr</a>(&amp;mut self, icr: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a>) { ... }
<div class="item-spacer"></div>    fn <a href="#method.is_enabled" class="fnname">is_enabled</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.bool.html">bool</a> { ... }
<div class="item-spacer"></div>    fn <a href="#method.setup_trigger" class="fnname">setup_trigger</a>(&amp;mut self, filter: <a class="enum" href="enum.Filter.html" title="enum stm32wlxx_hal::lptim::Filter">Filter</a>, pol: <a class="enum" href="enum.TrgPol.html" title="enum stm32wlxx_hal::lptim::TrgPol">TrgPol</a>, sel: Self::<a class="type" href="trait.LpTim.html#associatedtype.TrgSel" title="type stm32wlxx_hal::lptim::LpTim::TrgSel">TrgSel</a>) { ... }
</details>}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Low-power timer trait.</p>
</div></details><h2 id="associated-types" class="small-section-header">Associated Types<a href="#associated-types" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="associatedtype.TrgSel" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#276" title="goto source code">[src]</a></div><h4 class="code-header">type <a href="#associatedtype.TrgSel" class="type">TrgSel</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a>&gt;</h4></div></summary><div class="docblock"><p>Tigger selection options.</p>
</div></details></div><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="tymethod.new" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#301" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#tymethod.new" class="fnname">new</a>(tim: Self::Pac, clk: <a class="enum" href="enum.Clk.html" title="enum stm32wlxx_hal::lptim::Clk">Clk</a>, pre: <a class="enum" href="enum.Prescaler.html" title="enum stm32wlxx_hal::lptim::Prescaler">Prescaler</a>, rcc: &amp;mut <a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>) -&gt; Self</h4></div></summary><div class="docblock"><p>Create a new LPTIM driver.</p>
<p>This will enable the ADC clock and reset the ADC peripheral.</p>
<p><strong>Note:</strong> This will select the clock source, but you are responsible
for enabling that clock source.</p>
<h5 id="example" class="section-header"><a href="#example">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">stm32wlxx_hal</span>::{
    <span class="ident">lptim</span>::{<span class="self">self</span>, <span class="ident">LpTim</span>, <span class="ident">LpTim1</span>, <span class="ident">Prescaler::Div1</span>},
    <span class="ident">pac</span>,
};

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">dp</span>: <span class="ident">pac::Peripherals</span> <span class="op">=</span> <span class="ident">pac::Peripherals::take</span>().<span class="ident">unwrap</span>();

<span class="comment">// enable the HSI16 source clock</span>
<span class="ident">dp</span>.<span class="ident">RCC</span>.<span class="ident">cr</span>.<span class="ident">modify</span>(<span class="op">|</span><span class="kw">_</span>, <span class="ident">w</span><span class="op">|</span> <span class="ident">w</span>.<span class="ident">hsion</span>().<span class="ident">set_bit</span>());
<span class="kw">while</span> <span class="ident">dp</span>.<span class="ident">RCC</span>.<span class="ident">cr</span>.<span class="ident">read</span>().<span class="ident">hsirdy</span>().<span class="ident">is_not_ready</span>() {}

<span class="kw">let</span> <span class="ident">lptim1</span>: <span class="ident">LpTim1</span> <span class="op">=</span> <span class="ident">LpTim1::new</span>(<span class="ident">dp</span>.<span class="ident">LPTIM1</span>, <span class="ident">lptim::Clk::Hsi16</span>, <span class="ident">Div1</span>, <span class="kw-2">&amp;mut</span> <span class="ident">dp</span>.<span class="ident">RCC</span>);</code></pre></div>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.free" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#323" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#tymethod.free" class="fnname">free</a>(self) -&gt; Self::Pac</h4></div></summary><div class="docblock"><p>Free the LPTIM registers from the driver.</p>
<h5 id="example-1" class="section-header"><a href="#example-1">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">stm32wlxx_hal</span>::{
    <span class="ident">lptim</span>::{<span class="self">self</span>, <span class="ident">LpTim</span>, <span class="ident">LpTim1</span>, <span class="ident">Prescaler::Div1</span>},
    <span class="ident">pac</span>,
};

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">dp</span>: <span class="ident">pac::Peripherals</span> <span class="op">=</span> <span class="ident">pac::Peripherals::take</span>().<span class="ident">unwrap</span>();

<span class="comment">// enable the HSI16 source clock</span>
<span class="ident">dp</span>.<span class="ident">RCC</span>.<span class="ident">cr</span>.<span class="ident">modify</span>(<span class="op">|</span><span class="kw">_</span>, <span class="ident">w</span><span class="op">|</span> <span class="ident">w</span>.<span class="ident">hsion</span>().<span class="ident">set_bit</span>());
<span class="kw">while</span> <span class="ident">dp</span>.<span class="ident">RCC</span>.<span class="ident">cr</span>.<span class="ident">read</span>().<span class="ident">hsirdy</span>().<span class="ident">is_not_ready</span>() {}

<span class="kw">let</span> <span class="ident">lptim1</span>: <span class="ident">LpTim1</span> <span class="op">=</span> <span class="ident">LpTim1::new</span>(<span class="ident">dp</span>.<span class="ident">LPTIM1</span>, <span class="ident">lptim::Clk::Hsi16</span>, <span class="ident">Div1</span>, <span class="kw-2">&amp;mut</span> <span class="ident">dp</span>.<span class="ident">RCC</span>);
<span class="comment">// ... use lptim</span>
<span class="kw">let</span> <span class="ident">lptim1</span>: <span class="ident">pac::LPTIM1</span> <span class="op">=</span> <span class="ident">lptim1</span>.<span class="ident">free</span>();</code></pre></div>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.pulse_reset" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#333" title="goto source code">[src]</a></div><h4 class="code-header">unsafe fn <a href="#tymethod.pulse_reset" class="fnname">pulse_reset</a>(rcc: &amp;mut <a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>)</h4></div></summary><div class="docblock"><p>Reset the LPTIM peripheral.</p>
<p><a href="trait.LpTim.html#tymethod.new"><code>new</code></a> will pulse reset for you.</p>
<h5 id="safety" class="section-header"><a href="#safety">Safety</a></h5>
<ol>
<li>Ensure nothing is using the timer before calling this function.</li>
<li>You are responsible for setting up the timer after a reset.</li>
</ol>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.enable_clock" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#338" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#tymethod.enable_clock" class="fnname">enable_clock</a>(rcc: &amp;mut <a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>)</h4></div></summary><div class="docblock"><p>Enable clocks for the LPTIM peripheral.</p>
<p><a href="trait.LpTim.html#tymethod.new"><code>new</code></a> will enable clocks for you.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.disable_clock" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#346" title="goto source code">[src]</a></div><h4 class="code-header">unsafe fn <a href="#tymethod.disable_clock" class="fnname">disable_clock</a>(rcc: &amp;mut <a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>)</h4></div></summary><div class="docblock"><p>Disable the LPTIM peripheral clock.</p>
<h5 id="safety-1" class="section-header"><a href="#safety-1">Safety</a></h5>
<ol>
<li>Ensure nothing is using the timer before disabling the clock.</li>
<li>You are responsible for re-enabling the clock before using the timer.</li>
</ol>
</div></details><details class="rustdoc-toggle" open><summary><div id="tymethod.clk" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#362" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#tymethod.clk" class="fnname">clk</a>(rcc: &amp;<a class="struct" href="../pac/struct.RCC.html" title="struct stm32wlxx_hal::pac::RCC">RCC</a>) -&gt; <a class="enum" href="enum.Clk.html" title="enum stm32wlxx_hal::lptim::Clk">Clk</a></h4></div></summary><div class="docblock"><p>Get the clock source.</p>
<h5 id="example-2" class="section-header"><a href="#example-2">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">stm32wlxx_hal</span>::{
    <span class="ident">lptim</span>::{<span class="self">self</span>, <span class="ident">LpTim</span>, <span class="ident">LpTim1</span>},
    <span class="ident">pac</span>,
};

<span class="kw">let</span> <span class="ident">dp</span>: <span class="ident">pac::Peripherals</span> <span class="op">=</span> <span class="ident">pac::Peripherals::take</span>().<span class="ident">unwrap</span>();
<span class="comment">// PCLK is the power-on-reset value</span>
<span class="macro">assert_eq!</span>(<span class="ident">LpTim1::clk</span>(<span class="kw-2">&amp;</span><span class="ident">dp</span>.<span class="ident">RCC</span>), <span class="ident">lptim::Clk::Pclk</span>);</code></pre></div>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided methods<a href="#provided-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle" open><summary><div id="method.hz" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#383-385" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#method.hz" class="fnname">hz</a>(&amp;self) -&gt; &amp;<a class="struct" href="../struct.Ratio.html" title="struct stm32wlxx_hal::Ratio">Ratio</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a>&gt;</h4></div></summary><div class="docblock"><p>Get the clock speed in hertz.</p>
<h5 id="example-3" class="section-header"><a href="#example-3">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">stm32wlxx_hal</span>::{
    <span class="ident">lptim</span>::{<span class="self">self</span>, <span class="ident">LpTim</span>, <span class="ident">LpTim1</span>, <span class="ident">Prescaler::Div1</span>},
    <span class="ident">pac</span>,
};

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">dp</span>: <span class="ident">pac::Peripherals</span> <span class="op">=</span> <span class="ident">pac::Peripherals::take</span>().<span class="ident">unwrap</span>();

<span class="comment">// enable the HSI16 source clock</span>
<span class="ident">dp</span>.<span class="ident">RCC</span>.<span class="ident">cr</span>.<span class="ident">modify</span>(<span class="op">|</span><span class="kw">_</span>, <span class="ident">w</span><span class="op">|</span> <span class="ident">w</span>.<span class="ident">hsion</span>().<span class="ident">set_bit</span>());
<span class="kw">while</span> <span class="ident">dp</span>.<span class="ident">RCC</span>.<span class="ident">cr</span>.<span class="ident">read</span>().<span class="ident">hsirdy</span>().<span class="ident">is_not_ready</span>() {}

<span class="kw">let</span> <span class="ident">lptim1</span>: <span class="ident">LpTim1</span> <span class="op">=</span> <span class="ident">LpTim1::new</span>(<span class="ident">dp</span>.<span class="ident">LPTIM1</span>, <span class="ident">lptim::Clk::Hsi16</span>, <span class="ident">Div1</span>, <span class="kw-2">&amp;mut</span> <span class="ident">dp</span>.<span class="ident">RCC</span>);
<span class="macro">assert_eq!</span>(<span class="ident">lptim1</span>.<span class="ident">hz</span>().<span class="ident">to_integer</span>(), <span class="number">16_000_000</span>);</code></pre></div>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.cnt" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#389-392" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#method.cnt" class="fnname">cnt</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u16.html">u16</a></h4></div></summary><div class="docblock"><p>Get the timer count.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.isr" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#396-398" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#method.isr" class="fnname">isr</a>() -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a></h4></div></summary><div class="docblock"><p>Get the interrupt status.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.set_ier" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#426-429" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#method.set_ier" class="fnname">set_ier</a>(&amp;mut self, ier: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a>)</h4></div></summary><div class="docblock"><p>Enable and disable interrupts.</p>
<h5 id="panics" class="section-header"><a href="#panics">Panics</a></h5>
<ul>
<li>(debug) timer is enabled.</li>
</ul>
<h5 id="example-4" class="section-header"><a href="#example-4">Example</a></h5>
<p>Enable all IRQs.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">stm32wlxx_hal</span>::{
    <span class="ident">lptim</span>::{<span class="self">self</span>, <span class="ident">LpTim</span>, <span class="ident">LpTim1</span>, <span class="ident">Prescaler::Div1</span>},
    <span class="ident">pac</span>,
};

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">dp</span>: <span class="ident">pac::Peripherals</span> <span class="op">=</span> <span class="ident">pac::Peripherals::take</span>().<span class="ident">unwrap</span>();

<span class="comment">// enable the HSI16 source clock</span>
<span class="ident">dp</span>.<span class="ident">RCC</span>.<span class="ident">cr</span>.<span class="ident">modify</span>(<span class="op">|</span><span class="kw">_</span>, <span class="ident">w</span><span class="op">|</span> <span class="ident">w</span>.<span class="ident">hsion</span>().<span class="ident">set_bit</span>());
<span class="kw">while</span> <span class="ident">dp</span>.<span class="ident">RCC</span>.<span class="ident">cr</span>.<span class="ident">read</span>().<span class="ident">hsirdy</span>().<span class="ident">is_not_ready</span>() {}

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">lptim1</span>: <span class="ident">LpTim1</span> <span class="op">=</span> <span class="ident">LpTim1::new</span>(<span class="ident">dp</span>.<span class="ident">LPTIM1</span>, <span class="ident">lptim::Clk::Hsi16</span>, <span class="ident">Div1</span>, <span class="kw-2">&amp;mut</span> <span class="ident">dp</span>.<span class="ident">RCC</span>);
<span class="ident">lptim1</span>.<span class="ident">set_ier</span>(<span class="ident">lptim::irq::ALL</span>);</code></pre></div>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.set_icr" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#470-472" title="goto source code">[src]</a></div><h4 class="code-header">unsafe fn <a href="#method.set_icr" class="fnname">set_icr</a>(&amp;mut self, icr: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.u32.html">u32</a>)</h4></div></summary><div class="docblock"><p>Clear interrupts.</p>
<h5 id="safety-2" class="section-header"><a href="#safety-2">Safety</a></h5>
<p>There is a big erratum entry for interrupts getting stuck, and the
interrupts should only be cleared under certain circumstances
(see workaround).</p>
<h6 id="device-may-remain-stuck-in-lptim-interrupt-when-clearing-event-flag" class="section-header"><a href="#device-may-remain-stuck-in-lptim-interrupt-when-clearing-event-flag">Device may remain stuck in LPTIM interrupt when clearing event flag</a></h6><h6 id="description" class="section-header"><a href="#description">Description</a></h6>
<p>This limitation occurs when the LPTIM is configured in interrupt mode
(at least one interrupt is enabled) and the software clears any flag in
LPTIM_ISR register by writing its corresponding bit in LPTIM_ICR register.
If the interrupt status flag corresponding to a disabled interrupt is
cleared simultaneously with a new event detection,
the set and clear commands might reach the APB domain at the same time,
leading to an asynchronous interrupt signal permanently stuck high.
This issue can occur either during an interrupt subroutine execution
(where the flag clearing is usually done),
or outside an interrupt subroutine.
Consequently, the firmware remains stuck in the LPTIM interrupt routine,
and the device cannot enter Stop mode.</p>
<h6 id="workaround" class="section-header"><a href="#workaround">Workaround</a></h6>
<p>To avoid this issue, it is strongly advised to follow the recommendations
listed below:</p>
<ul>
<li>Clear the flag only when its corresponding interrupt is enabled in the
interrupt enable register.</li>
<li>If for specific reasons, it is required to clear some flags that have
corresponding interrupt lines disabled in the interrupt enable register,
it is recommended to clear them during the current subroutine prior to
those which have corresponding interrupt line enabled in the interrupt
enable register.</li>
<li>Flags must not be cleared outside the interrupt subroutine.</li>
</ul>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.is_enabled" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#475-477" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#method.is_enabled" class="fnname">is_enabled</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.bool.html">bool</a></h4></div></summary><div class="docblock"><p>Returns <code>true</code> if the timer is enabled.</p>
</div></details><details class="rustdoc-toggle" open><summary><div id="method.setup_trigger" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#484-491" title="goto source code">[src]</a></div><h4 class="code-header">fn <a href="#method.setup_trigger" class="fnname">setup_trigger</a>(&amp;mut self, filter: <a class="enum" href="enum.Filter.html" title="enum stm32wlxx_hal::lptim::Filter">Filter</a>, pol: <a class="enum" href="enum.TrgPol.html" title="enum stm32wlxx_hal::lptim::TrgPol">TrgPol</a>, sel: Self::<a class="type" href="trait.LpTim.html#associatedtype.TrgSel" title="type stm32wlxx_hal::lptim::LpTim::TrgSel">TrgSel</a>)</h4></div></summary><div class="docblock"><p>Setup a non-pin trigger.</p>
<h5 id="panics-1" class="section-header"><a href="#panics-1">Panics</a></h5>
<ul>
<li>(debug) timer is enabled.</li>
</ul>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-LpTim" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#494-540" title="goto source code">[src]</a></div><a href="#impl-LpTim" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="trait.LpTim.html" title="trait stm32wlxx_hal::lptim::LpTim">LpTim</a> for <a class="struct" href="struct.LpTim1.html" title="struct stm32wlxx_hal::lptim::LpTim1">LpTim1</a></h3></div></summary><div class="impl-items"><div id="associatedtype.TrgSel-1" class="type trait-impl has-srclink"><a href="#associatedtype.TrgSel-1" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.TrgSel" class="type">TrgSel</a> = <a class="enum" href="enum.TrgSel.html" title="enum stm32wlxx_hal::lptim::TrgSel">TrgSel</a></h4></div></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-LpTim-1" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#542-588" title="goto source code">[src]</a></div><a href="#impl-LpTim-1" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="trait.LpTim.html" title="trait stm32wlxx_hal::lptim::LpTim">LpTim</a> for <a class="struct" href="struct.LpTim2.html" title="struct stm32wlxx_hal::lptim::LpTim2">LpTim2</a></h3></div></summary><div class="impl-items"><div id="associatedtype.TrgSel-2" class="type trait-impl has-srclink"><a href="#associatedtype.TrgSel-2" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.TrgSel" class="type">TrgSel</a> = <a class="enum" href="enum.TrgSel.html" title="enum stm32wlxx_hal::lptim::TrgSel">TrgSel</a></h4></div></div></details><details class="rustdoc-toggle implementors-toggle"><summary><div id="impl-LpTim-2" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/stm32wlxx_hal/lptim/mod.rs.html#590-636" title="goto source code">[src]</a></div><a href="#impl-LpTim-2" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="trait.LpTim.html" title="trait stm32wlxx_hal::lptim::LpTim">LpTim</a> for <a class="struct" href="struct.LpTim3.html" title="struct stm32wlxx_hal::lptim::LpTim3">LpTim3</a></h3></div></summary><div class="impl-items"><div id="associatedtype.TrgSel-3" class="type trait-impl has-srclink"><a href="#associatedtype.TrgSel-3" class="anchor"></a><h4 class="code-header">type <a href="#associatedtype.TrgSel" class="type">TrgSel</a> = <a class="enum" href="enum.TrgSel3.html" title="enum stm32wlxx_hal::lptim::TrgSel3">TrgSel3</a></h4></div></div></details></div><script type="text/javascript" src="../../implementors/stm32wlxx_hal/lptim/trait.LpTim.js" async></script></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="stm32wlxx_hal" data-search-index-js="../../search-index.js" data-search-js="../../search.js"></div>
    <script src="../../main.js"></script>
</body></html>